---
title: 撸一个超简易富文本编辑器
date: 2019-05-07 11:31:00
summary: 
desc: 
tag: 
category: 其他
---
### 前言
印象中，富文本编辑器一直是一个高大上的玩意儿，想实现一个应该也挺难的。既然如此，那必须得学啊，这篇文章就是记录如何实现一个超简易的富文本编辑器。

### 实现方式
实现富文本编辑器通常来说有两种方式：

#### 给元素设置 contenteditable='true'
```
<div contenteditable="true">
  设置 contenteditable='true' 后，该元素内的内容就是可以编辑了。
</div>

```

#### 设置 iframe 的 designMode 为 'on'
```
<iframe style="width: 500px;height: 330px;"></iframe>
<script>
    var ifr = document.getElementsByTagName('iframe')[0]
    function printText() {
      // 输出内容
      console.log(ifr.contentWindow.document.body.innerHTML)
    }
    function init() {
      var doc = ifr.contentWindow.document
      doc.designMode = 'on'
      doc.body.innerHTML = '<div>设置 iframe 的 designMode</div>'
    }
    init()
</script>
```
现在大多数都使用 contenteditable='true' 方法来实现富文本编辑器，我这里也使用这种方式

### document​.exec​Command
定义：当一个HTML文档切换到设计模式时，document暴露 execCommand 方法，该方法允许运行命令来操纵可编辑内容区域的元素。
使用：document.execCommand(aCommandName, aShowDefaultUI, aValueArgument)
参数：
- aCommandName 命令的名称，具体可看[命令列表](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/execCommand#%E5%91%BD%E4%BB%A4)
- aShowDefaultUI 布尔值，是否展示用户界面，一般为 false。
- aValueArgument 额外的命令参数，默认为 null。

> 可以使用 document.queryCommandSupported(commandName) 来检测是否支持命令

#### 命令列表
详细的可以查看[这里](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/execCommand#%E5%91%BD%E4%BB%A4)，这里只列一些常见的：
```
backColor
修改文档的背景颜色。在styleWithCss模式下，则只影响容器元素的背景颜色。这需要一个<color> 类型的字符串值作为参数传入。注意，IE浏览器用这个设置文字的背景颜色。

bold
开启或关闭选中文字或插入点的粗体字效果。IE浏览器使用 <strong>标签，而不是<b>标签。

createLink
将选中内容创建为一个锚链接。这个命令需要一个hrefURI字符串作为参数值传入。URI必须包含至少一个字符，例如一个空格。（浏览器会创建一个空链接）

copy
拷贝当前选中内容到剪贴板。启用这个功能的条件因浏览器不同而不同，而且不同时期，其启用条件也不尽相同。使用之前请检查浏览器兼容表，以确定是否可用。

cut
剪贴当前选中的文字并复制到剪贴板。启用这个功能的条件因浏览器不同而不同，而且不同时期，其启用条件也不尽相同。使用之前请检查浏览器兼容表，以确定是否可用。

delete
删除选中部分.

fontName
在插入点或者选中文字部分修改字体名称. 需要提供一个字体名称字符串 (例如："Arial")作为参数。

fontSize
在插入点或者选中文字部分修改字体大小. 需要提供一个HTML字体尺寸 (1-7) 作为参数。

foreColor
在插入点或者选中文字部分修改字体颜色. 需要提供一个颜色值字符串作为参数。

heading
添加一个标题标签在光标处或者所选文字上。 需要提供 aValueArgument 参数 (例如. "H1", "H6"). (IE 和 Safari不支持)

italic
在光标插入点开启或关闭斜体字。 (Internet Explorer 使用 EM 标签，而不是 I )

justifyCenter、justifyFull、justifyLeft、justifyRight
对光标插入位置或者所选内容进行文字居中、文本对齐、左对齐、右对齐。

selectAll
选中编辑区里的全部内容。

redo
重做被撤销的操作。

undo
撤销最近执行的命令。
```

### 未完待续